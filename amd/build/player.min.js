define("qtype_audio/player",["jquery","core/ajax"],(function($,Ajax){function loadScreenQtypeAudio($type){return 1==$type?'\n            <div class="qtype_audio">\n                <div class="start_audio">\n                    <div class="icon_lestening">\n                        <i class="fa-solid fa-headphones fa-5xl" style="color: #ffffff;"></i>\n                    </div>\n                    <div class="description">\n                        <p>You will be listening to an audio clip during this test. You will not be permitted to pause or rewind the audio while answering the questions.</p>\n                        <p>To continue, click Play.</p>\n                        <button class="btn btn-play-audio" type="button">\n                            <i class="fa fa-play-circle fa-xl" aria-hidden="true"></i>\n                            <span class="caption">Play</span>\n                        </button>\n                    </div>\n                </div>\n            </div>':2==$type?'\n            <div class="qtype_audio click_to_continue">\n                <div class="start_audio">\n                <div class="icon_lestening">\n                        <i class="fa-solid fa-headphones fa-5xl" style="color: #ffffff;"></i>\n                    </div>\n                    <div class="description">\n                        <p>Click anywhere to continue</p>\n                    </div>\n                </div>\n            </div>\n            ':null}return{init:function(){const audio=document.getElementById("audio_in_page"),queryString=window.location.search,urlParams=new URLSearchParams(queryString),cmid=urlParams.get("cmid"),attemptid=urlParams.get("attempt");if($body=$("body"),$isAttepmt=$body.is("#page-mod-quiz-attempt"),!$isAttepmt)return;function toogleOffScloll($status){$status&&$isAttepmt?$body.addClass("overflow-hidden"):$body.removeClass("overflow-hidden")}let saveTimeInterval;function saveAudioTime(currentTime){Ajax.call([{methodname:"qtype_audio_update_playback_time",args:{cmid:parseInt(cmid),attemptid:parseInt(attemptid),audio_current_time:currentTime},done:function(response){response.status||console.error("Failed to update audio time: "+response.message)},fail:function(error){console.error("AJAX error: "+error.message)}}])}function startSavingTime(){saveTimeInterval=setInterval((()=>{saveAudioTime(audio.currentTime)}),5e3)}function addStatusAudioPlaying(){audio.paused?$(".audio-playing").remove():0==$(".audio-playing").length&&$(".quiz-timer-inner").append('<span style="font-weight: normal; font-size: medium;" class="audio-playing"><i class="fa fa-volume-up" aria-hidden="true"></i>Audio is playing</span>')}$html="",$(audio).on("pause ended play",(function(){saveAudioTime(audio.currentTime),addStatusAudioPlaying()})),new Promise(((resolve,reject)=>{Ajax.call([{methodname:"qtype_audio_get_playback_time",args:{cmid:parseInt(cmid),attemptid:parseInt(attemptid)},done:function(response){response&&response.status?resolve(response.audio_current_time):resolve(0)},fail:function(error){console.error("AJAX error: "+error.message),resolve(0)}}])})).then((savedTime=>{if(savedTime>0)return audio.currentTime=parseFloat(savedTime),void(savedTime<Math.round(audio.duration)&&(toogleOffScloll(!0),$html=loadScreenQtypeAudio(2),$body.append($html),$(".click_to_continue").on("click",(function(){audio.play(),toogleOffScloll(!1),startSavingTime(),$(".qtype_audio").remove(),addStatusAudioPlaying()}))));toogleOffScloll(!0),$html=loadScreenQtypeAudio(1),$body.append($html),$(".btn-play-audio").on("click",(function(){audio.play(),startSavingTime(),toogleOffScloll(!1),$(".qtype_audio").remove(),addStatusAudioPlaying()}))}))}}}));

//# sourceMappingURL=player.min.js.map